# 个人面试

**这里的问题并非全都是面经，还有一些是我的提前准备**

这里需要注意的是，在面试的时候一定要胆子大，也就是敢说，就算一个问题你不会，也要试图用会的内容尝试解决他，引导面试官去问你会的内容。

如果真不会，或者回答不上来（也就是大脑一片空白了），别磕巴，直接说没了解过或者没遇到过，这样至少能给面试官留下一个较好的性格印象。

还有就是不需要所有的都去编，因为有的问题可能就是学生自己完成不了的（比如你写你自己完成了一套特别特别nb的系统，然后面试官一问实际情况你一点回答不出来），这里你就实际的去说就好。但是你不能应该会的不会（比如一些微服务或者特别底层的可以不会，但是你的项目中遇到的问题或者具体实现的方式如果都不知道的话那可太扯了）

## 个人介绍

面试官您好，我目前大学在读，正在读大二，是软件工程专业。我平日主要使用Java与Kotlin语言通过SpringBoot框架进行后端方向的开发。熟悉使用MySQL，Redis等技术栈，同时学习过SpringCloud，SpringAI等框架，具有一定的分布式项目与Ai项目的开发能力。平日我会将我自己学习的内容更新到我的Github个人主页上，目前也已经有了五六万行的数据量。然后项目部分的话，这两个项目是我自己设计开发的，已经使用Git同步更新到了Github上，第一个项目主要是一个涉及到分布式的图文交流论坛，第二个则是基于SpringAI框架的本地Agent服务。

## 项目中遇到过什么问题

在分布式项目中，我曾经遇到过Gateway结合SaToken的时候在网关层通过Id获取Token获取不到的问题，当时这个问题我发现只会在第一次请求这个用户的Token的时候出现，于是我去查询了Satoken的仓库的issue，发现并没有人提过这个issue，于是我只能自己在Ai的帮助下尝试解决这个问题，最后我通过他的异常发现可能是Satoken第一次请求的时候没有初始化导致的，于是我查询了Satoken的Filter的Order，发现他的值是-100，于是我将我自己网关层的Filter的Order降到了-90，进而在Satoken的Filter之后进行，从而保证了Satoken的Filter一定在我之前完成，经过实际测试，这一操作确实也解决了第一次获取Token获取不到的问题

## 你的项目开发流程

因为我的项目只有我一个人进行开发，所以我进可能的尝试去模拟正式的一个开发流程，由于我的分布式项目使用了DDD的开发模式，所以我会先尝试去进行一个小的建模，去找到一个问题域的聚合根，然后争取将业务集中在domain中完成。部署的话我会现在服务器上部署一套CI/CD系统，然后通过Git提交项目后进行一个自动化的部署。

## 你说你用了CI/CD的流程，能介绍一下是如何实现的吗

好的，早期的话我的CI/CD系统的话主要是使用了Gitea+Jekins进行的部署，Jekins自动的获取Gitea的git信息，当git提交数据到Gitea之后就会自动的拉取Gitea仓库中的数据进行项目的构建与部署。

后来由于我的项目模块变多，一个个的通过上传到Gitea上拉取部署过于不便了，所以我决定使用打包Docker镜像的方式来进行部署，这里也就将项目改成了Gitea+Harbor+Jekins+Docker+Docker File的形式进行部署（引入了Harbor）。然后通过在项目中编写Docker File文件来创建Docker镜像，让Jenkins自动获取仓库中的DockerFile文件在进行自动的使用Docker构建镜像，然后上传到Harbor到，再通过Docker拉取Harbor中的Docker镜像来部署项目

## 你这是个微服务项目，那你统计过微服务模块的数量以及部署需要的服务器吗

这里我选择诚实说，因为我确实没有进行过微服务的实际部署，这也是可以接受的，毕竟每个人的学校水平不同，我所在的学校环境无法为我提供一个大型的微服务环境，我也没有实力自己去开好几台服务器进行部署。

**有的问题如果不会实话实说就好，毕竟有的情况是可以接受的。如果接受不了（不论是你还是面试官）那只能去背，不过这就要保证你得不露馅了**

总共应该有十个左右模块，然后的话由于这个项目是我自己在开发，我也没有能力和环境去支付高昂的服务器费用，所以只是在我自己的电脑上启动虚拟机部署了一下，根据测试大概需要10+g的内存才能运行。

## 我看你提到了DDD，说说DDD是什么

啊，DDD的话就是领域驱动设计嘛（Domain Driven Design），是一种以Domain为核心的设计模式，争取将所有的业务集中在Domain层或者说是领域对象中解决。在我的项目中使用了六边形架构，每一个模块的话都依赖于核心的Domain模块，（然后对外的过程依赖于infrastructure模块）力争让项目结构分工明确

## Redis Key重复了怎么办

**这里就是一个问题，面试官可能想问的是Redis底层的HashMap如何解决的Hash冲突问题，但是你不会，你可以尝试用业务的方式解答一下，万一面试官不接着往下问了呢**

因为系统采用了Leaf框架进行分布式Id生成，因此一般不会产生Key重复的情况，所以我会先检查是不是代码哪里写出了问题导致的Key重复，如果不是代码问题那么我会选择使用Lua脚本来对redis进行一个先查询再存入的过程。如果还是无法避免的话可能就要考虑是不是我的业务整体设计的存在问题。

**实际，面试官可能是想表达Hash冲突怎么办**

这是一个数据结构结合真实实现的问题，HashMap真实的情况是会根据你传入的Key去计算Key的hash值，也就是说不论什么类型的Key（Redis中都是String，但Java并非如此），都会被计算成为一个Hash值，然后通过这个Hash值去分配地址，这个Hash值大概率是不会冲突的，但也确实可能存在两个不同的Key最后计算的Hash一样的情况，这时就需要解决Hash冲突，Redis中采取的是链地址法方案，也就是说如果oldKey的值和newKey的值冲突了，会将newKey插在oldKey的位置，然后newKey中专门分配一块内存用来指向oldKey，即让oldKey插在newKey的后面（尾插法）

## Redis内存不足怎么办

Redis是基于内存的，所以Redis中存放的数据一般都是一些热点的讯息，如果Redis内存不足，那就要查看是不是有的数据应该去主动的给他设计一个过期时间，让他去自动的过期删除掉，如果实在没有问题，那就可能要考虑是不是需要去增加物理内存

## Redis的常用数据结构

Redis是键值对数据库，也就是所有的数据都是K-V的形式存在，其中K肯定是String类型，所以这里提及的是V的区别

String，Set，ZSet，List，HashMap，以及一些拓展类型（布隆过滤器，bitmap）

## 我看你压测了Leaf框架，你是如何完成的？

我使用了Jmeter来对我的服务进行压测，并且取得了较好的效果。

我先是在我的服务里专门启动了一个对外的API，他只提供一个创建Id的作用，然后我在Jmeter里会开启多个线程组，模拟多个并发用户进行车市，并且运行了一段时间模拟高峰期。我查询Jmeter的聚合报告和吞吐量图得到了项目的性能。

## Leaf是个怎样的框架

Leaf提供了号段模式和SnowFlake模式，我在项目中使用的是号段模式，他需要在数据库中引入Leaf的特定表并且进行一定的配置，然后他会从数据库中批量的获取ID然后在内存中分配，减少数据库的压力，除此之外Leaf还支持一种snowflake模式，他是基于zookeeper实现的，通过获取机器ID和时间戳来进行生成一个唯一的雪花ID

## 我看你使用了Nacos？你用Nacos做了什么，为什么要使用Nacos？

首先Nacos是Spring Cloud Alibaba体系中的一个配置中心，用来管理微服务，由于我的微服务中存在一些一样的配置内容，所以我将他们一并放到了Nacos中，然后使用Nacos进行统一的配置，这样就减少了我重复写配置文件的过程，除此之外，Nacos还提供了动态更新配置的功能，这使得我不再需要只为了修改一下配置文件就要重启服务，Nacos还提供了监视心跳的功能，来监控微服务是否健康。而且项目中的其他的Cloud组件也需要通过Nacos中对微服务的命名来寻找微服务。

## RBAC具体在你的项目中是如何体现的，为什么选择Satoken，如何在Gateway中实现的鉴权

RBAC就是Role-Based-Access-Control嘛，也就是通过将权限分配给角色，再将角色分配给用户的方式来完成的权限管理，实现了用户与权限的解耦。

使用Satoken主要是因为他相对Spring Security更加轻量化，更加易用。而且他是国内的开源框架，提供一流的中文文档与技术支持，我认为这也是在技术选型上值得思考的一点。

我在Gateway中使用了GlobalFilter这个全局过滤器，让每个请求在经过网关的时候先通过这个过滤器，然后将userId

