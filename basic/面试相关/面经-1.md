
# 面经-1

**base：杭州，规模：中小厂**

**整体没有考察八股文，重要考察点在项目的真实性和面试者只身的业务能力**

## 自我介绍一下

完全背诵

## 我看你是大二，能说一下为什么选择这时候来上班吗

我很早就有在了解目前的行业现状，由于我的自身学历不容乐观，根据目前的行业现状我只能选择在实习方面让自己更加有竞争力

## 你有参加过什么比赛吗

**画外音：这里面试官特别的表现出了他想要的是学科竞赛相关的内容，实际并不了解/关心算法竞赛，由此得出他想要的是应试者是否具有一定的团队协作能力**

## 我看你有使用一个分布式的Id框架，然后进行了压测，那你对整个项目有进行过压测吗

这里回答的不是很好，只是说了仅对一部分接口做了压测，得到了较好的结果，然后面试官立刻反问是否有具体数据，这下直接寄了。

给出一个通过AI总结的回答。

我这边的话针对一些核心的业务进行了压测，主要是Id的生成，因为他要被频繁的使用，经过我的实际测试，在每秒五万次的高并发下，99.9%的相应都在1ms以下，还有热点查询功能，我会发现通过三级缓存的效果可以把数据库的查询压力降到60%以下。ES的模糊搜索速度比直接数据库查询提高95%

拓展问题：这些数据是如何得到的

Id：我会通过Jmeter开启一个线程组然后配置足够多的并发用户，同时设置一个较短的启动时间，模拟瞬时的高并发，当压测启动后，我会查看JMeter的聚合报告，这里会直接给出QPS

缓存：我会先清空缓存，然后注解掉代码中的缓存部分，进而完成对MySQL的压测，然后我会恢复缓存，同时通过提前让数据进入到缓存中再进行压测，然后关注数据库的整体情况，二者进行对比获取缓存效果

## 我看你项目中通过Rocket进行了一个异步的消息发送，同时进行了SpringRetry兜底，那你对于用户来说是如何保证消息一定成功的

**这里实际上是我没有想到的，于是只能开编，以下是原本的情况**

Q：为什么你会使用MQ异步

A：因为这个插入过程可能较慢，我不希望用户等待这个时间

Q：那你如何保证消息一定发送成功呢？

A：首先的话是MQ，他自己有一个重试机制，这就已经一定程度上兜底了，然后就是我又引入SpringRetry框架，这样能进一步兜底，我认为这是可以接受的。

Q：那么无论怎么兜底都会失败不是吗，你如何保证消息的成功呢？

A：我在代码实现中其实并没有立刻返回成功，这一块的话我的项目只是立刻返回了一个200，但是前端用户可以看到的是一个”帖子正在发送的“友好提示，如果实在失败的话我会使用MQ自带的回调去通知用户。

Q：那么用户是如何获取这个消息的呢？

A：我会在前端那里为用户提供一个查看帖子发送情况的共功能，那里能自动拉取查看发送失败的帖子。

**一个结合AI的可能较好的回答版本**

A：嗯，多层兜底确实可能没用，但是我认为使用MQ的ACK机制进行多次重试和Spring Retry的兜底已经是很完善的方案了，我们可以保证的是在正常情况下大多数的请求通过这一套机制都是没有问题的。

如果实在有问题的话，我这边首先是前端，虽然返回给用户的是200的响应码，但是前端其实显示的是”帖子正在发送，请一段时间后检查帖子状况“，这样就及时的提示了用户这个消息可能存在发帖失败的情况，然后如果真的失败的话，我会使用一个回调，然后将这个消息及时的通知给用户，让用户知道自己的帖子发送失败了

Q：你能详细的说说回调这一块吗

A：好的，我的回调使用的是一种站内信的形式，当帖子发送失败的时候，我会及时的将失败的讯息发送到一个专门的表中，然后再通过SSE的形式通知用户存在帖子有问题。