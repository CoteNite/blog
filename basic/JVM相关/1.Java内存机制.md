# Java内存机制


如果想要理解JVM，那么我们就要知道JVM存在的意义是什么。

在C语言中，如果我们主动的去申请了一段空间，如何申请，申请后那么就需要后续通过free的方式去将其释放掉。我相信大多数熟练的工程师应该不会忘掉free的这一步骤，但是这一步骤实在显得有些麻烦，且何时free也是一个问题。

为了简化工程师的思考，方便程序员进行编程，Java决定将这一过程交给JVM去处理，而本文则是去试图阐述这一过程。

## 存储

我们都知道，数据在我们是存储在我们的电脑内存中的，那么究竟是如何存储的呢？

首先，根据线程的关系，我们可以将其分为 **线程私有和线程共有** 这两部分。

其中

**线程私有的：**

- 程序计数器
- 虚拟机栈
- 本地方法栈

**线程共享的：**

- 堆
- 方法区
- 直接内存 (非运行时数据区的一部分)

接下来我们试着依次去解释这些东西。

## 程序计数器

我们都知道，在并发环境下，多个线程是依次执行的，在线程切换的过程中，我们需要找一个区域去存放我们的程序现在执行到了何处/下一行代码该执行哪个，这就是程序计数器要完成的任务。

由于控制着下一条命令的选取，因此字节码解释器只需要对程序计数器进行修改就可以完成循环，判断等复杂操作。

**由于记录的是当前程序要执行的下一条，因此程序计数器是线程私有的。**

**由于程序计数器维护的是一个动态变化的东西（即下一条指令是什么/只是记录一个固定量的东西），且会随着线程的结束而消亡，因此不会OOM**

## Java虚拟机栈

