# 计算机网络（期末复习）

[极之心————计算机网络救急课堂](https://www.bilibili.com/video/BV1Ju4y157wh?spm_id_from=333.788.videopod.episodes&vd_source=9376a85d54558433ad7f11594f35ffa4)

## IPV4

IP地址：32位点分十进制  4 * 8 例如127.0.0.1就是4  8位二进制=255

IP地址=网络号+主机号

所以IP地址总共2的32次方个

![image.png](https://raw.githubusercontent.com/CoteNite/Blog_img/master/blogImg/20251210220042.png)


ABC类为单播地址，只有单播地址可以分配给主机各接口

主机号全为0的为网络地址，可做源地址，不可做目的地址

主机号全为1的为广播地址，不可做源地址，可做目的地址

A类地址：0.0.0.0~127.255.255.255 (127 = 01111111)

其中网络号为0的地址为本网络，不可指派，网络号为127的地址的为本地环回地址，不可指派

每个A类网络（网络号不同认为为一个独立的网络）可以指派2的24次方-2个可指派的地址（除去全0和全1）


B类地址：128.0.0.0~191.255.255.255 

每个B类网络（网络号不同认为为一个独立的网络）可以指派2的24次方-2个地址（除去全0和全1）(B类地址网络号16位)

全球网络中有三个特殊的地址块

- 10.0.0.0~10.255.255.255
- 172.16.0.0~172.31.255.255
- 192.168.0.0~192.168.255.255

这些是专用地址，可重用

c类地址：192.0.0.0~223.255.255.255

### 总结

对于所有的网络，主机号全为0的为本网络地址，主机号全为1的为广播地址，这两个特别的地址不可指派，网络地址可做源地址不可做目的地址，广播地址可做目的地址不可做源地址

A类：网络号为8位，开头必须为0，后面32位为主机号，内含`0.0.0.0~127.255.255.255`，主机号全为0或全为1即`x.0.0.0`或`x.255.255.255`，**特别的，A类中0或127开头的不可指派**

B类：网络号为16位，开头必须为10，后面16位为主机号，内含`128.0.0.0~191.255.255.255`，主机号全为0或全为1即`x.x.0.0`或`x.x.255.255`

C类：网络号为24位，开头必须为110，后面8位为主机号，内含`192.0.0.0~223.255.255.255`，主机号全为0或全为1即`x.x.x.0`或`x.x.x.255`

三个特别的地址块，专用/可重用，可指派：

- 10.0.0.0~10.255.255.255
- 172.16.0.0~172.31.255.255
- 192.168.0.0~192.168.255.255

## 子网划分

主要是即使是一个C类地址，一个也可以分配2的8次方-2个地址，很有可能一个公司用不完，因此需要子网划分

子网划分的核心为**子网掩码**

主要干的事就是将网络号+主机号的形式转变成网络号+子网号+主机号，用连续的比特1表示网络号和子网号，用连续的比特0表示主机号

子网掩码仍然是32为二进制，但原地址主机号部分全部用1（也就是255）表示

举个例子：

IP：180.80.77.55 子网掩码：255.255.252.0

其中子网掩码前16位为255，确认为b类网络，252=（11111100） 6位1即子网号为6位

77.55=（010011（子网号）  01.00110111）

该主机所在的子网的广播地址为

180.80.010011 11.1111111  ->180.80.79.255

## 无分类的编制方法

当我们发现使用子网的情况下仍然太大时，我们就尝试是用了无分类的编制方法

**使用的是地址掩码**

用连续的比特1表示网络号，连续的0表示主机号，其中网络号的部分被称为CIDR地址块

举个例子：

地址掩码为255.255.240.0 -> 11111111 11111111 1111 | 0000 00000000

也就是20个1和12个0 即前20位为网络号，后12位为主机号

再看回其对应的IP地址——128.14.35.7

(10000000 00001110 0010)网络号 (0011 00000111)主机号

另一种写法就是 `x.x.x.x/y` 其中的y就是网络号的位数

## 掩码的总结

掩码是对IP地址的一个解释，其连续的1的数量和0的数量使用来区分IP地址中的哪些位是网络号，哪些是主机号，子网号

因此首要的操作肯定是将掩码转换成二进制，进而根据掩码中连续为1的位数去锁定ip中的位置，这一部分就是IP的网络号（+子网号），0的部分则是主机号

得到网络号的部分，我们就可以将其固定，然后剩下的部分就可以推得到其网络地址和广播地址

## IPV6

IPV4 -> IPV6  使用了双协议栈技术+隧道技术

IPV6的地址用128位冒号16进制表示，也就是8组，每组4个

ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff

由于过于难表示，因此采用`左侧0省略`+`连续0压缩`的方式表示

FE80: 0000:0000:0000:AAAA:00C2:00C2:0002

左侧0省略： 0:0:0:AAAA:0C2:0C2:02

连续0压缩： :: AAA :0C2:0C2:02  (也就是连续的0全部压缩为::)


值得一提的是连续0压缩可以用在IPV6的任何位置，但是只能使用一次，因此我们一边用在连续0最多的地方

   12AB:0000:0000:CD30:0000:0000:0000:0000
-> 12AB:0:0:CD30::

## RIP距离向量算法

现有路由器A收到如下的项目

![image.png](https://raw.githubusercontent.com/CoteNite/Blog_img/master/blogImg/20251211184238.png)

并受到C发来的路由

![image.png](https://raw.githubusercontent.com/CoteNite/Blog_img/master/blogImg/20251211184257.png)


第一步就是先将所有的C发来的信息更改为A视角的信息，即保留目的网络不变，所有到目的网络的距离+1（因为认为A收到C的信息，即C与A相邻，即距离为1），并将下一跳转换为C

然后与原本A的项目比较

1. 如果下一跳相同，但信息不同，则更新为A原有的
2. 如果下一跳不同，比长短，保留（A原有的）/更新（C现传的）为短的
3. 如果存在新项目，直接添加

## 协议首部

### IPV4的协议首部

总共占用20字节：

- 版本：占用4位，存协议版本，比如IPV4版本为4
- 首部长度：占用4位，表示整个首部的长度，单位是每4字节，也就是说首部长度为5，实际上表示首部有20字节
- 区分服务：占用8位
- 总长度，占用16位，首部+数据部分的总长度
- 标识：占用16位，类似计数器，产生了几个数据包，**所有分片的标识一致**
- 标志：占用3位，有三种状态，每一位代表一个状态，但其实只有两个有效的状态，即MF（More Fragment）和DF（Don't Fragment）表示数据包是否后续还有分片以及是否允许分片。针对DF位，**DF位的0和1的标准不是是否分片，而是是否可以分片**，能分片的数据就是0，1是特别的不允许分片的数据
- 片偏移：占用13位，表示该分片在原本整体中处于第几片的位置，分片的`起始位置/8`为片偏移（比如某一片的第一位为原数据的第1400位，则为1400/8=175），也就是以8字节为单位，这意味着每个分片的大小必须是8的倍数，没分片和第一片的片偏移为0
- 生存时间：占用8位，表示在传输过程中最大的存活时间
- 协议（号）：占用8位，每个协议固定的号，占用8位
- 首部检验和：占用16位，用来检验是否与误码
- 源地址：占用32位，表示发送数据包的源地址
- 目的地址：占用32位，表示接受数据包的目的地址

MTU：数据报的最大长度（包含首部）

当MTU最大化利用的情况下片偏移非整数时，则使用可以被整除的最大部分（即每个分片为最大的可被8整除的数，且分片数还要最少）

### IPV6的协议首部

IPV6的首部为40字节：

- 